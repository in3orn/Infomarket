{% extends 'benchmark/index.html.twig' %}

{% set mainPath = 'product' %}
{% set title = title|default('title.products')|trans %}
	
{% block content %}
	<div class="container-fluid">
		<div class="col-sm-2">
			{% block sidebar %}
				<div class="col-xs-12">
					<h3>{{ entry.brand.name }}</h3>
					<h3>{{ entry.name }}</h3>
				</div>
				
				<div class="col-xs-12">
					<p>
						<a class="btn btn-primary" href="{{ path(basePath ~ mainPath ~ '_show', { id: entry.id }) }}">
							<span class="fa fa-eye"></span>
							{{ 'action.show'|trans }}
						</a>
					</p>
				</div>
				{% if not entry.custom %}
					<div class="col-xs-12">
						{% if benchmarkMessage %}
							{% set messagePath = basePath ~ 'benchmark_message_show' %}
							{% set messageParams = { id: benchmarkMessage.id } %}
						{% else %}
							{% set messagePath = basePath ~ 'benchmark_message_new' %}
							{% set messageParams = { product: entry.id } %}
						{% endif %}
						<p>
							<a class="btn btn-danger" href="{{ path(messagePath, messageParams) }}">
								<span class="fa fa-exclamation-circle"></span>
								{{ 'action.reportError'|trans }}
							</a>
						</p>
					</div>
				{% endif %}
			{% endblock %}
		</div>
		<div class="col-sm-10">
			{% block tableContent %}
				{% set restWidth = 90 - 15 - entries|length * 15 %}
				<table class="table table-striped vert-align">
					<tr>
						<th width="10%">&nbsp</th>
						<td width="15%"></td>
						{% for entry in entries %}
							<td width="15%"></td>
						{% endfor %}
						<td width="{{ restWidth }}%"></td>
					</tr>
					<tr>
						<th></th>
						<td>
							<div class="rect">
								<div class="div-center">
									<img class="img-responsive" alt="{{ entry.name }}" src="{{ asset(entry.image) }}" />
								</div>
							</div>
						</td>
						{% for entry in entries %}
							<td>
								<div class="rect">
									<div class="div-center">
										<img class="img-responsive" alt="{{ entry.name }}" src="{{ asset(entry.image) }}" />
									</div>
								</div>
							</td>
						{% endfor %}
						<td></td>
					</tr>
					<tr>
						<th class="text-right">{{ 'label.brand'|trans }}</th>
						<th class="text-center">{{ entry.brand.name }}</th>
						{% for entry in entries %}
							<th class="text-center">{{ entry.brandName }}</th>
						{% endfor %}
						<th></th>
					</tr>
					<tr>
						<th class="text-right">{{ 'label.benchmark.product.name'|trans }}</th>
						<th class="text-center">{{ entry.name }}</th>
						{% for entry in entries %}
							<th class="text-center">{{ entry.name }}</th>
						{% endfor %}
						<th></th>
					</tr>
					<tr>
						<th class="text-right">{{ 'label.benchmark.product.price'|trans }}</th>
						<th class="text-center">{{ entry.price|number_format(2, '.', ' ') }}</th>
						{% for compared in entries %}
							{% if compared.price > entry.price %}	
								{% set color = 'text-success' %}
								{% set icon = 'arrow-circle-up' %}
							{% elseif compared.price < entry.price %}	
								{% set color = 'text-danger' %}
								{% set icon = 'arrow-circle-down' %}
							{% else %}
								{% set color = 'text-primary' %}
								{% set icon = 'stop-circle' %}
							{% endif %}
							<td class="text-center {{ color }}">
								{{ compared.price|number_format(2, '.', ' ') }}
								<span class="fa fa-{{ icon }}"></span>
							</td>
						{% endfor %}
						<td></td>
					</tr>
					
					{% for field in benchmarkFields %}
						{% set key = field.valueField %}
						<tr>
							<th class="text-right">{{ field.fieldName }}</th>
							<th class="text-center">
								{% if field.fieldType == constant('AppBundle\\Entity\\BenchmarkField::BOOLEAN_FIELD_TYPE') %}
									{% if entry[key] %}
										<span class="text-success fa fa-check-circle"></span>
									{% else %}
										<span class="text-danger fa fa-minus-circle"></span>
									{% endif %}
								{% elseif field.fieldType == constant('AppBundle\\Entity\\BenchmarkField::DECIMAL_FIELD_TYPE') %}
									{{ entry[key] ? entry[key]|number_format(field.decimalPlaces, '.', ' ') : '' }}
						        {% else %}
							        {{ entry[key] }}
								{% endif%}
							</th>
							{% for compared in entries %}
								<td class="text-center">
									{% if field.fieldType == constant('AppBundle\\Entity\\BenchmarkField::BOOLEAN_FIELD_TYPE') %}
										{% if compared[key] %}
											<span class="text-success fa fa-check-circle"></span>
										{% else %}
											<span class="text-danger fa fa-minus-circle"></span>
										{% endif %}
									{% elseif field.fieldType == constant('AppBundle\\Entity\\BenchmarkField::DECIMAL_FIELD_TYPE') or 
												field.fieldType == constant('AppBundle\\Entity\\BenchmarkField::INTEGER_FIELD_TYPE') %}
										
										{% if field.betterThanType == constant('AppBundle\\Entity\\BenchmarkField::GT_BETTER_THAN_TYPE') %}
											{% if compared[key] > entry[key] %}	
												{% set color = 'text-success' %}
												{% set icon = 'arrow-circle-up' %}
											{% elseif compared[key] < entry[key] %}	
												{% set color = 'text-danger' %}
												{% set icon = 'arrow-circle-down' %}
											{% else %}
												{% set color = 'text-primary' %}
												{% set icon = 'minus-circle' %}
											{% endif %}
										{% elseif field.betterThanType == constant('AppBundle\\Entity\\BenchmarkField::LT_BETTER_THAN_TYPE') %}
											{% if compared[key] > entry[key] %}	
												{% set color = 'text-danger' %}
												{% set icon = 'arrow-circle-up' %}
											{% elseif compared[key] < entry[key] %}	
												{% set color = 'text-success' %}
												{% set icon = 'arrow-circle-down' %}
											{% else %}
												{% set color = 'text-primary' %}
												{% set icon = 'minus-circle' %}
											{% endif %}
										{% endif %}
										<span class="{{ color }}">
											{{ compared[key] ? compared[key]|number_format(field.decimalPlaces, '.', ' ') : '' }} 
											<span class="fa fa-{{ icon }}"></span>
										</span>
										
							        {% else %}
								        {{ compared[key] }}
									{% endif%}
								</td>
							{% endfor %}
							<td></td>
						</tr>
					{% endfor %}
					
					<tr>
						<th class="text-right">{{ 'label.actions'|trans }}</th>
						<th class="text-center"></th>
						{% for entry in entries %}
							<td class="text-center">
								<a class="btn btn-primary" href="{{ path(basePath ~ mainPath ~ '_show', { id: entry.id }) }}" title="{{ 'action.show'|trans }}">
									<span class="fa fa-eye"></span>
								</a>
								<a class="btn btn-warning" href="{{ path(basePath ~ mainPath ~ '_compare', { id: entry.id }) }}" title="{{ 'action.compare'|trans }}">
									<span class="fa fa-balance-scale"></span>
								</a>
								{% if entry.benchmarkMessage %}
									{% set messagePath = basePath ~ 'benchmark_message_show' %}
									{% set messageParams = { id: entry.benchmarkMessage.id } %}
								{% else %}
									{% set messagePath = basePath ~ 'benchmark_message_new' %}
									{% set messageParams = { product: entry.id } %}
								{% endif %}
								<a class="btn btn-danger" href="{{ path(messagePath, messageParams) }}" title="{{ 'action.reportError'|trans }}">
									<span class="fa fa-exclamation-circle"></span>
								</a>
							</td>
						{% endfor %}
						<td></td>
					</tr>
					
				</table>
			{% endblock %}
		</div>	
	</div>
{% endblock %}
