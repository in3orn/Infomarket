{% set infomarket = infomarket | default(false) %}
{% set infoprodukt = infoprodukt | default(false) %}

<li>
	{% set caretClass = caretClass|default('') %}
	
	{% if entry.children | length > 0 %}
		<a class="trigger right-caret {{ caretClass }}">
			{{ entry.name | raw }}
		</a>
		<ul class="dropdown-menu sub-menu">
			{% for subentry in entry.children %}
			
				{% if infomarket and subentry.infomarket %}
					{% set show = false %}
					
					{% for menuEntryBranchAssignment in subentry.menuEntryBranchAssignments if show == false %}
						{% if menuEntryBranchAssignment.branch.id == branch.id %}
							{% set show = true %}
						{% endif %}
					{% endfor %}
	      							
					{% if show %}
						{% include 'common/menu/menu_entry.html.twig' with { 'entry': subentry } %}
					{% endif %}
				
				{% elseif infoprodukt and subentry.infoprodukt %}
					{% include 'common/menu/menu_entry.html.twig' with { 'entry': subentry } %}
				{% endif %}
				
			{% endfor %}
		</ul>
	{% else %}
		{% if entry.page %}
			<a href="{{ path(basePath ~ 'page_show', { id: entry.page.id}) }}">{{ entry.name }}</a>
		{% elseif entry.link %}
			<a href="{{ entry.link.url }}">{{ entry.name }}</a>
		{% else %}
			<a href="#">{{ entry.name }}</a>
		{% endif %}
	{% endif %}
</li>