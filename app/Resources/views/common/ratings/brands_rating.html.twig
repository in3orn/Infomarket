{% set show = false %}
{% for entry in segments %}
	{% if attribute(brands, entry.id) | length > 0 %}
		{% set show = true %}
	{% endif %}
{% endfor %}

{% for category in subcategories %}
	{% for segment in segments %}
		{% if attribute(attribute(subbrands, category.id), segment.id) | length > 0 %}
			{% set show = true %}
		{% endif %}
	{% endfor %}
{% endfor %}
	
{% if show %}		
	<div class="col-xs-12 no-side-padding well">
		
		<div class="col-xs-12">
			<h2><span class="fa fa-globe"></span> {{ 'label.rating.brands'|trans }}</h2>
		</div>
		
		{% set show = false %}
		{% for entry in segments %}
			{% if attribute(brands, entry.id) | length > 0 %}
				{% set show = true %}
			{% endif %}
		{% endfor %}
		
		{% if show %}
			<div class="row no-side-padding">
				<div class="col-xs-12">
					<div class="hidden-xs col-sm-4 col-md-2"><h3 class="text-center">{{ 'label.segment'|trans }}</h3></div>
					<div class="hidden-xs col-sm-8 col-md-10"><h3 class="text-center">{{ 'label.rating.brands'|trans }}</h3></div>
				</div>
			</div>
			
			{% for segment in segments %}
				{% if attribute(brands, segment.id) | length > 0 %}
					<div class="row no-side-padding bkg-segment-{{ segment.id }}">
						<div class="col-xs-12">
							
							<div class="col-xs-12 col-sm-4 col-md-2 no-padding">
								<div class="rect">
									{% if segment.image %}
										<img class="div-center img-{{ segment.vertical ? 'v' : '' }}responsive" 
											alt="{{ segment.name | raw }}" src="{{ asset(segment.getImagePath()) }}">
									{% endif %}
								</div>
							</div>
							
							{% for brand in attribute(brands, segment.id) %}
								{% if loop.index > 1 and loop.index % 2 == 1 %}
									<div class="col-sm-4 col-md-2 no-padding hidden-xs hidden-md hidden-lg">
									</div>
								{% endif %}
								{% if loop.index > 1 and loop.index % 5 == 1 %}
									<div class="col-sm-4 col-md-2 no-padding hidden-xs hidden-sm">
									</div>
								{% endif %}
								<div class="col-sm-4 col-md-2 no-padding">
									<div class="rect bkg-white">
										{% if brand.image %}
											<a href="{{ path(basePath ~ 'brand_show', {'id': brand.id }) }}">
												<img class="div-center img-{{ brand.vertical ? 'v' : '' }}responsive" 
													alt="{{ brand.name }}" src="{{ asset(brand.getImagePath()) }}">
											</a>
										{% endif %}
									</div>
								</div>
							{% endfor %}
							
						</div>
					</div>
					
					<div class="vr-space-10"></div>
				{% endif %}
			{% endfor %}
		{% endif %}
		
		
		{% for category in subcategories %}
			
			{% set show = false %}
			{% for segment in segments %}
				{% if attribute(attribute(subbrands, category.id), segment.id) | length > 0 %}
					{% set show = true %}
				{% endif %}
			{% endfor %}
		
			{% if show %}
				<div class="col-xs-12">
					<h2>
						<span class="text-red">{{ category.name }}</span>  
						<span class="text-blue"{{ category.subname }}</span> 
					</h2>
				</div>
				
				<div class="row no-side-padding">
					<div class="col-xs-12">
						<div class="hidden-xs col-sm-4 col-md-2"><h3 class="text-center">{{ 'label.segment'|trans }}</h3></div>
						<div class="hidden-xs col-sm-8 col-md-10"><h3 class="text-center">{{ 'label.rating.brands'|trans }}</h3></div>
					</div>
				</div>
				
				{% for segment in segments %}
					{% if attribute(attribute(subbrands, category.id), segment.id) | length > 0 %}
						<div class="row no-side-padding bkg-segment-{{ segment.id }}">
							<div class="col-xs-12">
								
								<div class="col-xs-12 col-sm-4 col-md-2 no-padding">
									<div class="rect">
										{% if segment.image %}
											<img class="div-center img-{{ segment.vertical ? 'v' : '' }}responsive" 
												alt="{{ segment.name | raw }}" src="{{ asset(segment.getImagePath()) }}">
										{% endif %}
									</div>
								</div>
								
								{% for brand in attribute(attribute(subbrands, category.id), segment.id) %}
									{% if loop.index > 1 and loop.index % 2 == 1 %}
										<div class="col-sm-4 col-md-2 no-padding hidden-xs hidden-md hidden-lg">
										</div>
									{% endif %}
									{% if loop.index > 1 and loop.index % 5 == 1 %}
										<div class="col-sm-4 col-md-2 no-padding hidden-xs hidden-sm">
										</div>
									{% endif %}
									<div class="col-sm-4 col-md-2 no-padding">
										<div class="rect bkg-white">
											{% if brand.image %}
												<a href="{{ path(basePath ~ 'brand_show', {'id': brand.id }) }}">
													<img class="div-center img-{{ brand.vertical ? 'v' : '' }}responsive" 
														alt="{{ brand.name }}" src="{{ asset(brand.getImagePath()) }}">
												</a>
											{% endif %}
										</div>
									</div>
								{% endfor %}
							
							</div>
						</div>
						
						<div class="vr-space-20"></div>
					{% endif %}
				{% endfor %}
			{% endif %}
			
		{% endfor %}
	
	
	
	</div>
{% endif %}