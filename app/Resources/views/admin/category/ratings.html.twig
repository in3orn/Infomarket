{% extends 'admin/index.html.twig' %}

{% set mainPath = 'category' %}
{% set title = 'title.ratings'|trans  %}

{% block content %}

	<h2>{{ entry.name }} {{ entry.subname }}</h2>
	
	{% for segment in entry.segments %}
		<div class="row">
			<h3>{{ 'label.segment'|trans }} {{ segment.name }}</h3>
			
			<div class="row equal">
			
				<div class="col-md-6">
					<div class="row equal">
						<div class="col-xs-6 col-md-3">
							<h3>{{ 'title.products'|trans }}</h3>
						</div>
						{% if is_granted('ROLE_EDITOR') %}
							<div class="col-xs-6 col-md-3">
								<a href="{{ path('admin_product_category_assignment_new', { category: entry.id, segment: segment.id }) }}"
									class="btn btn-success text-xs-bottom-mm">
									<span class="fa fa-plus"></span> 
									{{ 'action.assignProduct'|trans }} 
								</a>
							</div>
						{% endif %}
					</div>
					
					<table class="table table-striped vert-align">
						<tbody>
						{% for productCategoryAssignment in entry.productCategoryAssignments %}
							{% if productCategoryAssignment.segment.id == segment.id %}
							<tr>
								<td>
									<div class="circle bkg-white" width="20" height="20">
										{% if productCategoryAssignment.product.image %}
											<img class="div-center img-{{ productCategoryAssignment.product.vertical ? '' : 'v' }}responsive"
												alt="{{ productCategoryAssignment.product.image }}" src="{{ asset(productCategoryAssignment.product.getImagePath()) }}" />
										{% endif %}
									</div>
								</td>
								<td>
									{% if productCategoryAssignment.product.brand %}
									<a href="{{ path('admin_brand_show', { id: productCategoryAssignment.product.brand.id }) }}"> 
										{{ productCategoryAssignment.product.brand.name }}
									</a>
									{% endif %}
								</td>
								<td>
									<a href="{{ path('admin_product_show', { id: productCategoryAssignment.product.id }) }}">
										{{ productCategoryAssignment.product.name }}
									</a>
								</td>
								{% if is_granted('ROLE_EDITOR') %}
									<td>
										<a href="{{ path('admin_product_category_assignment_edit', { id: productCategoryAssignment.id }) }}" class="btn btn-warning">
											<span class="fa fa-edit"></span> 
											{{ 'action.edit'|trans }}
										</a>
										<a href="{{ path('admin_product_category_assignment_delete', { id: productCategoryAssignment.id }) }}" class="btn btn-danger">
											<span class="fa fa-trash"></span> 
											{{ 'action.delete'|trans }}
										</a>
									</td>
								{% endif %}
							</tr>
							{% endif %}
						{% endfor %}
						</tbody>
					</table>
				</div>
			
				<div class="col-md-6">
					<div class="row equal">
						<div class="col-xs-6 col-md-3">
							<h3>{{ 'title.brands'|trans }}</h3>
						</div>
						{% if is_granted('ROLE_EDITOR') %}
							<div class="col-xs-6 col-md-3">
								<a href="{{ path('admin_brand_category_assignment_new', { category: entry.id, segment: segment.id }) }}"
									class="btn btn-success text-xs-bottom-mm">
									<span class="fa fa-plus"></span> 
									{{ 'action.assignBrand'|trans }} 
								</a>
							</div>
						{% endif %}
					</div>
					
					<table class="table table-striped vert-align">
						<tbody>
						{% for brandCategoryAssignment in entry.brandCategoryAssignments %}
							{% if brandCategoryAssignment.segment.id == segment.id %}
							<tr>
								<td>
									<div class="circle bkg-white" width="20" height="20">
										{% if brandCategoryAssignment.brand.image %}
											<img class="div-center img-{{ brandCategoryAssignment.brand.vertical ? '' : 'v' }}responsive"
												alt="{{ brandCategoryAssignment.brand.image }}" src="{{ asset(brandCategoryAssignment.brand.getImagePath()) }}" />
										{% endif %}
									</div>
								</td>
								<td>
									<a href="{{ path('admin_brand_show', { id: brandCategoryAssignment.brand.id }) }}">
										{{ brandCategoryAssignment.brand.name }}
									</a>
								</td>
								{% if is_granted('ROLE_EDITOR') %}
									<td>
										<a href="{{ path('admin_brand_category_assignment_edit', { id: brandCategoryAssignment.id }) }}" class="btn btn-warning">
											<span class="fa fa-edit"></span> 
											{{ 'action.edit'|trans }}
										</a>
										<a href="{{ path('admin_brand_category_assignment_delete', { id: brandCategoryAssignment.id }) }}" class="btn btn-danger">
											<span class="fa fa-trash"></span> 
											{{ 'action.delete'|trans }}
										</a>
									</td>
								{% endif %}
							</tr>
							{% endif %}
						{% endfor %}
						</tbody>
					</table>
				</div>
				
			</div>
			
		</div>
	{% endfor %}

	<div class="row lowered-25">
	
	<div class="btn-group col-xs-12">
		<a type="button" class="btn btn-primary" href="{{ path(route, routeParams) }}">
			<i class="fa fa-close"></i>{{ 'action.back'|trans }}
		</a>
	</div>
		
{% endblock %}
